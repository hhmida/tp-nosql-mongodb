<!DOCTYPE html>
<html class="no-js" lang="fr"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Atelier MongoDB" name="description"/><link href="https://hhmida.github.io/tp-nosql-mongodb/crud.html" rel="canonical"/><meta content="Hmida Hmida" name="author"/><link href="assets/images/leaf.png" rel="shortcut icon"/><meta content="mkdocs-1.1.2, mkdocs-material-6.0.2" name="generator"/><title>Opérations de base - Bases de données NoSQL avec MongoDB</title><link href="assets/stylesheets/main.38780c08.min.css" rel="stylesheet"/><link href="assets/stylesheets/palette.3f72e892.min.css" rel="stylesheet"/><meta content="#2094f3" name="theme-color"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","None","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script><script async="" src="https://www.google-analytics.com/analytics.js"></script></head> <body data-md-color-accent="red" data-md-color-primary="blue" data-md-color-scheme="" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#operations-de-base"> Aller au contenu </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header-nav md-grid"> <a aria-label="Bases de données NoSQL avec MongoDB" class="md-header-nav__button md-logo" href="https://hhmida.github.io/tp-nosql-mongodb" title="Bases de données NoSQL avec MongoDB"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"></path></svg> </a> <label class="md-header-nav__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg> </label> <div class="md-header-nav__title" data-md-component="header-title"> <div class="md-header-nav__ellipsis"> <span class="md-header-nav__topic md-ellipsis"> Bases de données NoSQL avec MongoDB </span> <span class="md-header-nav__topic md-ellipsis"> Opérations de base </span> </div> </div> <label class="md-header-nav__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Rechercher" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Rechercher" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </label> <button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg> </button> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link md-tabs__link--active" href="index.html"> Introduction </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Bases de données NoSQL avec MongoDB" class="md-nav__button md-logo" href="https://hhmida.github.io/tp-nosql-mongodb" title="Bases de données NoSQL avec MongoDB"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"></path></svg> </a> Bases de données NoSQL avec MongoDB </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="index.html"> Introduction </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="installation.html"> Installation et configuration </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> Opérations de base <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="crud.html"> Opérations de base </a> <nav aria-label="Table des matières" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table des matières </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#format-des-commandes-mongodb"> Format des commandes MongoDB </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#manipulation-des-bases-de-donnees"> Manipulation des bases de données </a> <nav aria-label="Manipulation des bases de données" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#lister-les-bases"> Lister les bases </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#selectionner-ou-creer-une-bd"> Sélectionner ou créer une BD </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#supprimer-la-base-de-donnees-en-cours"> Supprimer la base de données en cours </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#les-collections-de-la-base-en-cours"> Les collections de la base en cours </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#importation-de-donnees"> Importation de données </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#insertion-de-documents"> Insertion de documents </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#interrogation"> Interrogation </a> <nav aria-label="Interrogation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#format-de-la-methpde-find"> Format de la méthpde find() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#projection"> Projection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#contenu-de-collection"> Contenu de collection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#selection"> Sélection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#filtrage-avec-operateurs"> Filtrage avec opérateurs </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#mise-a-jour"> Mise à jour </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#suppression"> Suppression </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="advanced.html"> Opérations avancées </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="replication.html"> Replication </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="sharding.html"> Sharding </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table des matières" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table des matières </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#format-des-commandes-mongodb"> Format des commandes MongoDB </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#manipulation-des-bases-de-donnees"> Manipulation des bases de données </a> <nav aria-label="Manipulation des bases de données" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#lister-les-bases"> Lister les bases </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#selectionner-ou-creer-une-bd"> Sélectionner ou créer une BD </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#supprimer-la-base-de-donnees-en-cours"> Supprimer la base de données en cours </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#les-collections-de-la-base-en-cours"> Les collections de la base en cours </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#importation-de-donnees"> Importation de données </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#insertion-de-documents"> Insertion de documents </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#interrogation"> Interrogation </a> <nav aria-label="Interrogation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#format-de-la-methpde-find"> Format de la méthpde find() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#projection"> Projection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#contenu-de-collection"> Contenu de collection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#selection"> Sélection </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#filtrage-avec-operateurs"> Filtrage avec opérateurs </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#mise-a-jour"> Mise à jour </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#suppression"> Suppression </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content"> <article class="md-content__inner md-typeset"> <p><img height="30%" src="../docs/assets/images/crud/crud.png" width="30%"/></p> <h1 id="operations-de-base">Opérations de base<a class="headerlink" href="#operations-de-base" title="Permanent link">¶</a></h1> <hr/> <h2 id="format-des-commandes-mongodb">Format des commandes MongoDB<a class="headerlink" href="#format-des-commandes-mongodb" title="Permanent link">¶</a></h2> <details class="hint" open="open"><summary>Format des appels</summary><div class="highlight"><pre><span></span><code>  <span class="c1">//Appel d'opération sur la base en cours</span>
  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">operation</span><span class="p">()</span>

  <span class="c1">//Appel d'opération sur la collection</span>
  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">operation</span><span class="p">()</span>
</code></pre></div> </details> <h2 id="manipulation-des-bases-de-donnees">Manipulation des bases de données<a class="headerlink" href="#manipulation-des-bases-de-donnees" title="Permanent link">¶</a></h2> <h3 id="lister-les-bases">Lister les bases<a class="headerlink" href="#lister-les-bases" title="Permanent link">¶</a></h3> <details class="hint" open="open"><summary>show</summary><p>Voir les bases existantes</p> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">show</span> <span class="nx">dbs</span>
</code></pre></div> <p>Pour voir la base sélectionnée</p> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span>
</code></pre></div> </details> <h3 id="selectionner-ou-creer-une-bd">Sélectionner ou créer une BD<a class="headerlink" href="#selectionner-ou-creer-une-bd" title="Permanent link">¶</a></h3> <p>C'est la base qui sera active et représente par le préfixe <mark>db</mark>. Toutes les opérations exécutées ensuite sont exécutées sur cette base. </p> <details class="hint" open="open"><summary>use</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">use</span> <span class="nx">nom_base</span>
</code></pre></div> </details> <details class="example exemple" open="open"><summary>Example</summary><p>Créer une base bibliotheque</p> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">use</span> <span class="nx">bibliotheque</span>
</code></pre></div> </details> <h3 id="supprimer-la-base-de-donnees-en-cours">Supprimer la base de données en cours<a class="headerlink" href="#supprimer-la-base-de-donnees-en-cours" title="Permanent link">¶</a></h3> <details class="hint" open="open"><summary>dropDatabse</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">dropDatabse</span><span class="p">()</span>
</code></pre></div> </details> <details class="info" open="open"><summary>Afficher la liste des opérations sur une BD</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">help</span><span class="p">()</span>
</code></pre></div> </details> <h3 id="les-collections-de-la-base-en-cours">Les collections de la base en cours<a class="headerlink" href="#les-collections-de-la-base-en-cours" title="Permanent link">¶</a></h3> <details class="hint" open="open"><summary>Création de collection</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">(</span><span class="s2">"nom"</span><span class="p">)</span>
</code></pre></div> </details> <details class="example" open="open"><summary>Exemple</summary><p>Créer une collection livres</p> <div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">cretateCollection</span><span class="p">(</span><span class="s2">"livres"</span><span class="p">)</span>
</code></pre></div> </details> <details class="hint" open="open"><summary>Lister les collections</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">show</span> <span class="nx">collections</span>
</code></pre></div> </details> <details class="hint" open="open"><summary>Supprimer une collection</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">nom_collection</span><span class="p">.</span><span class="nx">drop</span><span class="p">()</span>
</code></pre></div> </details> <h3 id="importation-de-donnees">Importation de données<a class="headerlink" href="#importation-de-donnees" title="Permanent link">¶</a></h3> <p>Pour alimenter la base avec des données existantes dans un format supporté (JSON, CSV, TSV), c'est l'utilitaire <mark>mongoimport</mark> qui sera utilisé. </p> <details class="hint" open="open"><summary>mongoimport</summary><div class="tabbed-set" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"/><label for="__tabbed_1_1">Terminal Windows</label><div class="tabbed-content"></div> </div> <div class="highlight"><pre><span></span><code>  mongoimport <span class="o">[</span>-h host<span class="o">]</span> -d database -c collection <span class="o">[</span>--jsonarray<span class="o">]</span> fichier
</code></pre></div> </details> <details class="example" open="open"><summary>Exemple</summary><p>Importer le dataset des restaurants (voir Ressources).</p> <div class="tabbed-set" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"/><label for="__tabbed_2_1">Terminal Windows</label><div class="tabbed-content"></div> </div> <div class="highlight"><pre><span></span><code>mongoimport -d emplacements -c restaurants restaurants.json
</code></pre></div> </details> <h2 id="insertion-de-documents">Insertion de documents<a class="headerlink" href="#insertion-de-documents" title="Permanent link">¶</a></h2> <p>Un document est inséré dans une collection. Il est possible d'utiliser les méthodes <mark>insert()</mark>, <mark>insertOne()</mark> ou <mark>insertMany()</mark>.</p> <details class="example" open="open"><summary>Exemple</summary><div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">livres</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
  <span class="s2">"Titre"</span><span class="o">:</span><span class="s2">"Mongodb: the definitive guide, 2nd edition"</span><span class="p">,</span>
  <span class="s2">"Catégorie"</span><span class="o">:</span><span class="s2">"Informatique"</span><span class="p">,</span>
  <span class="s2">"Pages"</span><span class="o">:</span><span class="mi">434</span><span class="p">,</span>
  <span class="s2">"Année"</span><span class="o">:</span><span class="mi">2013</span><span class="p">,</span>
  <span class="s2">"Prix"</span><span class="o">:</span><span class="mf">42.73</span><span class="p">,</span>
  <span class="s2">"Résumé"</span><span class="o">:</span><span class="s2">"This updated second edition provides guidance for database developers, </span>
<span class="s2">  advanced configuration for system administrators, and an overview of the concepts </span>
<span class="s2">  and use cases for other people on your project."</span><span class="p">,</span>
  <span class="s2">"Langue"</span><span class="o">:</span><span class="s2">"EN"</span><span class="p">,</span>
  <span class="s2">"ISBN"</span><span class="o">:</span><span class="mi">9781449344689</span><span class="p">,</span>
  <span class="s2">"Editeur"</span><span class="o">:</span><span class="p">{</span><span class="s2">"Nom"</span><span class="o">:</span><span class="s2">""</span><span class="p">,</span><span class="s2">"Pays"</span><span class="o">:</span><span class="s2">""</span><span class="p">},</span>
  <span class="s2">"Auteurs"</span><span class="o">:</span><span class="p">[{</span><span class="s2">"Nom"</span><span class="o">:</span><span class="s2">"Chodorow"</span><span class="p">,</span><span class="s2">"Prénom"</span><span class="o">:</span><span class="s2">"Kristina"</span><span class="p">}],</span>
  <span class="s2">"Mots clés"</span><span class="o">:</span><span class="p">[</span><span class="s2">"MongoDB"</span><span class="p">,</span><span class="s2">"NoSQL"</span><span class="p">,</span><span class="s2">"Database"</span><span class="p">]</span>
<span class="p">})</span>
</code></pre></div> </details> <p><strong>Exercice</strong><br/> Ajouter le livre ayant cette couverture : </p> <p><img height="60%" src="../docs/assets/images/crud/livre.jpg" width="60%"/></p> <details class="info" open="open"><summary>Note</summary><ul> <li>MongoDB associe un identifiant unique à chaque document appelé <mark>_id</mark>, et lui attribue une valeur si elle n’est pas indiquée explicitement.</li> <li>MongoDB ne fait aucun contrôle de structure ou autres contraintes sur les données. Ces contrôles seront réalisées.</li> </ul> </details> <h2 id="interrogation">Interrogation<a class="headerlink" href="#interrogation" title="Permanent link">¶</a></h2> <p>C'est la méthode <mark>find()</mark> qui réalise l'interrogation dans MongoDB.<br/> Les requêtes seront effectuées sur la base de données des restaurants importée précédemment : <code class="highlight"><span class="nx">use</span> <span class="nx">emplacements</span></code></p> <h3 id="format-de-la-methpde-find">Format de la méthpde <mark>find()</mark><a class="headerlink" href="#format-de-la-methpde-find" title="Permanent link">¶</a></h3> <p><mark>find</mark> possède 2 paramètres optionnels représentés également en format JSON. Le premier représente la requête de filtrage (clause WHERE en SQL). Le second paramètre exprime l'opération la projection.</p> <details class="hint" open="open"><summary>find</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span> <span class="nx">projection</span><span class="p">)</span>
</code></pre></div> </details> <h3 id="projection">Projection<a class="headerlink" href="#projection" title="Permanent link">¶</a></h3> <div class="highlight"><pre><span></span><code>  <span class="p">{</span><span class="nx">clé</span><span class="o">:&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">}</span>
</code></pre></div> <p>0 : exclusion, 1 : inclusion</p> <details class="warning" open="open"><summary></summary><ul> <li>L'identifiant _id est implicitement inclus dans le résultat. Pour l'exclure, ajouter <strong>_id:0</strong>.</li> <li>Il n'est pas possible de mélanger inclusions et exclusions sauf pour le champ _id.</li> <li>Pour accéder à un champ d'un document imbriqué, utiliser <mark>.</mark> : <strong>champ1.champ2</strong>.</li> </ul> </details> <details class="example" open="open"><summary>Exemples</summary><p>Afficher les noms des restaurants et leurs spécialités (cuisine).</p> <div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"/><label for="__tabbed_3_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">({},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">cuisine</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span>
</code></pre></div> </div> <input id="__tabbed_3_2" name="__tabbed_3" type="radio"/><label for="__tabbed_3_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">cuisine</span> <span class="k">FROM</span> <span class="n">restaurants</span>
</code></pre></div> </div> </div> <p>Afficher tous les noms des restaurants et la rue (street) et pas le _id.</p> <div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"/><label for="__tabbed_4_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">({},{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"address.street"</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">_id</span><span class="o">:</span><span class="mi">0</span><span class="p">})</span>
</code></pre></div> </div> <input id="__tabbed_4_2" name="__tabbed_4" type="radio"/><label for="__tabbed_4_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">street</span> <span class="k">FROM</span> <span class="n">restaurants</span>
</code></pre></div> </div> </div> </details> <h3 id="contenu-de-collection">Contenu de collection<a class="headerlink" href="#contenu-de-collection" title="Permanent link">¶</a></h3> <p><mark>find()</mark> affiche le contenu de la collection tandis que <mark>count()</mark> retourne le nombre de documents de la collection.</p> <details class="example" open="open"><summary>Exemple</summary><div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"/><label for="__tabbed_5_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">count</span><span class="p">()</span>
</code></pre></div> </div> <input id="__tabbed_5_2" name="__tabbed_5" type="radio"/><label for="__tabbed_5_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">restaurants</span>
  <span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">restaurants</span>
</code></pre></div> </div> </div> </details> <h3 id="selection">Sélection<a class="headerlink" href="#selection" title="Permanent link">¶</a></h3> <details class="example" open="open"><summary>Exemples</summary><p>Trouver les restaurants du quartier Manhattan.</p> <div class="tabbed-set" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio"/><label for="__tabbed_6_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="s2">"borough"</span> <span class="o">:</span> <span class="s2">"Brooklyn"</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></div> </div> <input id="__tabbed_6_2" name="__tabbed_6" type="radio"/><label for="__tabbed_6_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">restaurants</span> <span class="k">WHERE</span> <span class="n">borough</span> <span class="o">=</span> <span class="s1">'Brooklyn'</span>
</code></pre></div> </div> </div> <p>Trouver les restaurants du quartier Manhattan offrant la cuisine italienne.</p> <div class="tabbed-set" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio"/><label for="__tabbed_7_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="s2">"borough"</span> <span class="o">:</span> <span class="s2">"Brooklyn"</span><span class="p">,</span> <span class="s2">"cuisine"</span><span class="o">:</span><span class="s2">"Italian"</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></div> </div> <input id="__tabbed_7_2" name="__tabbed_7" type="radio"/><label for="__tabbed_7_2">SQL</label><div class="tabbed-content"> <p><code>SQL SELECT * FROM restaurants WHERE borough = 'Brooklyn' and cuisine = 'Italian'</code></p> </div> </div> <p>Trouver les restaurants sans nom (<mark>null</mark>).</p> <div class="tabbed-set" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio"/><label for="__tabbed_8_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="s2">"name"</span> <span class="o">:</span> <span class="kc">null</span> <span class="p">}</span> <span class="p">)</span>
</code></pre></div> </div> <input id="__tabbed_8_2" name="__tabbed_8" type="radio"/><label for="__tabbed_8_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">restaurants</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="k">IS</span> <span class="k">NULL</span>
</code></pre></div> </div> </div> </details> <p><strong>Expressions régulières</strong></p> <p>Avec les champs de type texte, MongoDB accepte les expressions régulières sous le format <code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="err">/regex/options</span></code>.</p> <table> <thead> <tr> <th align="left"><strong>Option</strong></th> <th align="left"><strong>Description</strong></th> </tr> </thead> <tbody> <tr> <td align="left">i</td> <td align="left">insensible à la casse.</td> </tr> <tr> <td align="left">m</td> <td align="left">Multiligne.</td> </tr> </tbody> </table> <details class="example" open="open"><summary>Exemples</summary><p>Trouver les restaurants dont le nom contient <code>Pizza</code> sans prendre en compte la casse.</p> <div class="tabbed-set" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio"/><label for="__tabbed_9_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="s2">"name"</span> <span class="o">:</span> <span class="sr">/pizza/i</span><span class="p">})</span>
</code></pre></div> </div> <input id="__tabbed_9_2" name="__tabbed_9" type="radio"/><label for="__tabbed_9_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">restaurants</span> <span class="k">WHERE</span> <span class="k">upper</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">like</span> <span class="s1">'%PIZZA%'</span>
</code></pre></div> </div> </div> <p>Trouver les restaurants dont le nom commence par 'A'.</p> <div class="tabbed-set" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio"/><label for="__tabbed_10_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="s2">"name"</span> <span class="o">:</span> <span class="sr">/^A/</span><span class="p">})</span>
</code></pre></div> </div> <input id="__tabbed_10_2" name="__tabbed_10" type="radio"/><label for="__tabbed_10_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">restaurants</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="k">like</span> <span class="s1">'A%'</span>
</code></pre></div> </div> </div> <p>Trouver les restaurants dont le nom commence est composé de 7 caractères.</p> <div class="tabbed-set" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio"/><label for="__tabbed_11_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span> <span class="s2">"name"</span> <span class="o">:</span> <span class="sr">/^.{7}$/</span><span class="p">})</span>
</code></pre></div> </div> <input id="__tabbed_11_2" name="__tabbed_11" type="radio"/><label for="__tabbed_11_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">restaurants</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="k">like</span> <span class="s1">'_______'</span>
</code></pre></div> </div> </div> </details> <h3 id="filtrage-avec-operateurs">Filtrage avec opérateurs<a class="headerlink" href="#filtrage-avec-operateurs" title="Permanent link">¶</a></h3> <p>Pour construire les critères de sélection, plusieurs opérateurs peuvent être utilisés dans la requête selon le format : <code class="highlight"><span class="p">{</span><span class="nx">champ1</span><span class="o">:</span><span class="p">{</span><span class="o">&lt;</span><span class="nx">opérateur</span><span class="o">&gt;:&lt;</span><span class="nx">valeur1</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...}</span></code></p> <p><strong>Les opérateurs</strong> </p> <table> <thead> <tr> <th align="left"><strong>Opérateur</strong></th> <th align="center"><strong>Rôle</strong></th> <th align="left"><strong>Exemple</strong></th> </tr> </thead> <tbody> <tr> <td align="left"><strong>$gt, $gte</strong></td> <td align="center">&gt;,&gt;=</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$gt"</span><span class="o">:</span><span class="mi">10</span><span class="p">}</span></code></td> </tr> <tr> <td align="left"><strong>$lt, $lte</strong></td> <td align="center">&lt;,&lt;=</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$lt"</span><span class="o">:</span><span class="mi">10</span><span class="p">}</span></code></td> </tr> <tr> <td align="left"><strong>$ne</strong></td> <td align="center">!=</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$ne"</span><span class="o">:</span><span class="mi">10</span><span class="p">}</span></code></td> </tr> <tr> <td align="left"><strong>$in, $nin</strong></td> <td align="center">IN, NOT IN</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$in"</span><span class="o">:</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]}</span></code></td> </tr> <tr> <td align="left"><strong>$or</strong></td> <td align="center">ou logique</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$or"</span><span class="o">:</span><span class="p">[{</span><span class="s2">"$gt"</span><span class="o">:</span><span class="mi">10</span><span class="p">},{</span><span class="s2">"$lt"</span><span class="o">:</span><span class="mi">5</span><span class="p">}]}</span></code></td> </tr> <tr> <td align="left"><strong>$and</strong></td> <td align="center">et logique</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$and"</span><span class="o">:</span><span class="p">[{</span><span class="s2">"$lt"</span><span class="o">:</span><span class="mi">10</span><span class="p">},{</span><span class="s2">"$gt"</span><span class="o">:</span><span class="mi">5</span><span class="p">}]}</span></code></td> </tr> <tr> <td align="left"><strong>$not</strong></td> <td align="center">négation</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$not"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$gt"</span><span class="o">:</span><span class="mi">10</span><span class="p">}}</span></code></td> </tr> <tr> <td align="left"><strong>$exists</strong></td> <td align="center">Existence de la clé dans le document</td> <td align="left"><code class="highlight"><span class="s2">"champ"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$exist"</span><span class="o">:</span><span class="mi">1</span><span class="p">}</span></code></td> </tr> <tr> <td align="left"><strong>$size</strong></td> <td align="center">taille d'une champ array</td> <td align="left"><code class="highlight"><span class="s2">"champTableau"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$size"</span><span class="o">:</span><span class="mi">5</span><span class="p">}</span></code></td> </tr> <tr> <td align="left"><strong>$elemMatch</strong></td> <td align="center">vérification conjointe de plusieurs conditions sur un élément du tableau</td> <td align="left"><code class="highlight"><span class="s2">"champTableau"</span><span class="o">:</span><span class="p">{</span><span class="nx">$elemMatch</span><span class="o">:</span><span class="p">{</span><span class="s2">"champInterne"</span><span class="o">:</span><span class="p">{</span><span class="nx">$gt</span><span class="o">:</span><span class="mi">5</span><span class="p">}}}</span></code></td> </tr> </tbody> </table> <details class="example" open="open"><summary>Exemple 1</summary><p>Trouver les noms et scores des restaurants de Manhattan ayant reçu au moins un score inférieur à 10.</p> <div class="tabbed-set" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio"/><label for="__tabbed_12_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span>
    <span class="nx">borough</span><span class="o">:</span><span class="s2">"Manhattan"</span><span class="p">,</span>
    <span class="s2">"grades.score"</span><span class="o">:</span><span class="p">{</span><span class="s2">"$lt"</span><span class="o">:</span><span class="mi">10</span><span class="p">}</span>
  <span class="p">},</span> 
  <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">"grades.score"</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">_id</span><span class="o">:</span><span class="mi">0</span><span class="p">})</span>
</code></pre></div> </div> </div> </details> <details class="example" open="open"><summary>Exemple 2</summary><p>Trouver les noms et scores des restaurants de Manhattan avec des scores tous inférieur à 10.</p> <div class="tabbed-set" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio"/><label for="__tabbed_13_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="p">{</span>
    <span class="nx">borough</span><span class="o">:</span><span class="s2">"Manhattan"</span><span class="p">,</span>
    <span class="s2">"grades.score"</span><span class="o">:</span><span class="p">{</span><span class="nx">$not</span><span class="o">:</span><span class="p">{</span><span class="s2">"$lt"</span><span class="o">:</span><span class="mi">10</span><span class="p">}}</span>
  <span class="p">},</span> 
  <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">"grades.score"</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">_id</span><span class="o">:</span><span class="mi">0</span><span class="p">})</span>
</code></pre></div> </div> </div> </details> <details class="example" open="open"><summary>Exemple 3</summary><p>Trouver les restaurants qui ont une évaluation ayant un grade ‘C’ avec un score inférieur à 40.</p> <div class="tabbed-set" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio"/><label for="__tabbed_14_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
    <span class="s2">"grades"</span> <span class="o">:</span><span class="p">{</span>
      <span class="nx">$elemMatch</span> <span class="o">:</span><span class="p">{</span>
        <span class="s2">"grade"</span> <span class="o">:</span> <span class="s2">"C"</span><span class="p">,</span>
        <span class="s2">"score"</span> <span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span> <span class="o">:</span><span class="mi">40</span><span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span><span class="s2">"grades.score"</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="nx">_id</span><span class="o">:</span><span class="mi">0</span><span class="p">})</span>
</code></pre></div> </div> </div> <details class="warning" open="open"><summary></summary><p><mark>$elemMatch</mark> permet de vérifier les conditions sur le même élément du tableau. Sans cet opérateur on obtient des évaluations avec des scores différents de 30 ou des grades différents de C.</p> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
    <span class="s2">"grades.grade"</span> <span class="o">:</span> <span class="s2">"C"</span><span class="p">,</span>
    <span class="s2">"grades.score"</span> <span class="o">:</span> <span class="p">{</span><span class="nx">$lt</span> <span class="o">:</span> <span class="mi">30</span><span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span><span class="s2">"Grades.grade"</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"grades.score"</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span>
</code></pre></div> </details> </details> <details class="example" open="open"><summary>Exemple 4</summary><p>Trouver les restaurants qui ont une exactement 4 évaluations.</p> <div class="tabbed-set" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio"/><label for="__tabbed_15_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
    <span class="s2">"grades"</span> <span class="o">:</span><span class="p">{</span><span class="nx">$size</span><span class="o">:</span><span class="mi">4</span><span class="p">}</span>
  <span class="p">})</span>
</code></pre></div> </div> </div> </details> <details class="example" open="open"><summary>Exemple 5</summary><p>Trouver les restaurants qui ont une longitude (la première valeur de coordinates) &lt; -100.</p> <div class="tabbed-set" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio"/><label for="__tabbed_16_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
    <span class="s2">"address.coord.coordinates.0"</span> <span class="o">:</span><span class="p">{</span><span class="nx">$lt</span><span class="o">:-</span><span class="mi">100</span><span class="p">}</span>
  <span class="p">})</span>
</code></pre></div> </div> </div> </details> <p><strong>Distinct</strong><br/> Pour déterminer les valeurs distinctes d'un champ. </p> <details class="example" open="open"><summary>Exemples</summary><p>Trouver les différents quartiers.</p> <div class="tabbed-set" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio"/><label for="__tabbed_17_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">distinct</span><span class="p">(</span><span class="s2">"borough"</span><span class="p">)</span>
</code></pre></div> </div> <input id="__tabbed_17_2" name="__tabbed_17" type="radio"/><label for="__tabbed_17_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">SELECT</span> <span class="k">distinct</span> <span class="n">borough</span> <span class="k">FROM</span> <span class="n">restaurants</span>
</code></pre></div> </div> </div> <p>Trouver l'intervalle des scores.</p> <div class="tabbed-set" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio"/><label for="__tabbed_18_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">distinct</span><span class="p">(</span><span class="s2">"grades.score"</span><span class="p">)</span>
</code></pre></div> </div> </div> </details> <h2 id="mise-a-jour">Mise à jour<a class="headerlink" href="#mise-a-jour" title="Permanent link">¶</a></h2> <details class="hint" open="open"><summary>Update</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span>
    <span class="p">{</span><span class="nx">filtre</span><span class="p">},</span>
    <span class="p">{</span>
      <span class="o">&lt;</span><span class="nx">opérateurUpdate</span><span class="o">&gt;:</span><span class="p">{</span><span class="o">&lt;</span><span class="nx">champ1</span><span class="o">&gt;:&lt;</span><span class="nx">valeur1</span><span class="o">&gt;</span><span class="p">,....},</span>
      <span class="o">&lt;</span><span class="nx">opérateurUpdate</span><span class="o">&gt;:</span><span class="p">{</span><span class="o">&lt;</span><span class="nx">champ1</span><span class="o">&gt;:&lt;</span><span class="nx">valeur1</span><span class="o">&gt;</span><span class="p">,....},</span>
      <span class="p">....</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">"multi"</span><span class="o">:</span><span class="kc">true</span><span class="o">|</span><span class="kc">false</span><span class="p">,</span> <span class="c1">//mise à jour de plusieurs documents - par défaut false</span>
      <span class="s2">"upsert"</span><span class="o">:</span><span class="kc">true</span><span class="o">|</span><span class="kc">false</span> <span class="c1">//insertion si aucun document ne correspond - par défaut false</span>
    <span class="p">}</span>
  <span class="p">)</span>
</code></pre></div> </details> <p><strong>Opérateurs de mise à jour</strong></p> <table> <thead> <tr> <th align="center"><strong>Opérateur</strong></th> <th align="left"><strong>Description</strong></th> <th align="left"><strong>Exemple</strong></th> </tr> </thead> <tbody> <tr> <td align="center"><strong>$currentDate</strong></td> <td align="left">Affecter à un champ la date en cours</td> <td align="left"><code class="highlight"><span class="nx">$currentDate</span><span class="o">:</span><span class="p">{</span><span class="s2">"champ"</span><span class="o">:</span><span class="kc">true</span><span class="p">}</span></code></td> </tr> <tr> <td align="center"><strong>$inc, $mul</strong></td> <td align="left">Incrémenter resp. multiplier la valeur d'un champ par une valeur</td> <td align="left"><code class="highlight"><span class="nx">$inc</span><span class="o">:</span><span class="p">{</span><span class="s2">"champ"</span><span class="o">:</span><span class="mi">5</span><span class="p">}</span></code></td> </tr> <tr> <td align="center"><strong>$min, $max</strong></td> <td align="left">Modifie le champ si la nouvelle valeur est inférieure resp. supérieure à la valeur actuelle.</td> <td align="left"><code class="highlight"><span class="nx">$min</span><span class="o">:</span><span class="p">{</span><span class="s2">"champ"</span><span class="o">:</span><span class="mi">10</span><span class="p">}</span></code></td> </tr> <tr> <td align="center"><strong>$rename</strong></td> <td align="left">Renommer un champ.</td> <td align="left"><code class="highlight"><span class="nx">$rename</span><span class="p">{</span><span class="s2">"champ"</span><span class="o">:</span><span class="s2">"nouveauChamp"</span><span class="p">}</span></code></td> </tr> <tr> <td align="center"><strong>$set</strong></td> <td align="left">Affecte une valeur au champ spécifié et l'ajoute s'il n'existe pas.</td> <td align="left"><code class="highlight"><span class="nx">$set</span><span class="o">:</span><span class="p">{</span><span class="s2">"champ"</span><span class="o">:</span><span class="mi">2</span><span class="p">}</span></code></td> </tr> <tr> <td align="center"><strong>$unset</strong></td> <td align="left">Supprime le champ du document.</td> <td align="left"><code class="highlight"><span class="nx">$unset</span><span class="p">{</span><span class="s2">"champ"</span><span class="o">:</span><span class="s2">""</span><span class="p">}</span></code></td> </tr> <tr> <td align="center"><strong>$pop</strong></td> <td align="left">Supprime le premier ou dernier élément d'un champ tableau.</td> <td align="left"><code class="highlight"><span class="nx">$pop</span><span class="p">{</span><span class="s2">"champTableau"</span><span class="o">:-</span><span class="mi">1</span><span class="p">}</span></code> -1: premier, 1:dernier</td> </tr> <tr> <td align="center"><strong>$pull</strong></td> <td align="left">Supprime les éléments qui vérifient la condition.</td> <td align="left"><code class="highlight"><span class="nx">$pull</span><span class="p">{</span><span class="s2">"champTableau"</span><span class="o">:</span><span class="nx">condition</span><span class="p">}</span></code></td> </tr> <tr> <td align="center"><strong>$push</strong></td> <td align="left">Ajoute un ou plusieurs éléments au tableau à une position.</td> <td align="left"><code class="highlight"><span class="nx">$push</span><span class="p">{</span><span class="s2">"champTableau"</span><span class="o">:</span><span class="p">{</span><span class="nx">$each</span><span class="o">:</span><span class="p">[</span><span class="nx">valeur1</span><span class="p">,</span> <span class="nx">valeur2</span><span class="p">,...],</span> <span class="nx">$position</span><span class="o">:</span> <span class="nx">positionInsertion</span><span class="p">}}</span></code></td> </tr> </tbody> </table> <details class="example" open="open"><summary>Exemple 1</summary><p>Modifier le champ borough en 'Manhattan' et affecter la date actuelle au champ lastupdate du restaurant avec l'identifiant 5f7cefe98c3d2e2bd862b3fe</p> <div class="tabbed-set" data-tabs="19:2"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio"/><label for="__tabbed_19_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span>
    <span class="p">{</span><span class="nx">_id</span><span class="o">:</span><span class="nx">ObjectId</span><span class="p">(</span><span class="s2">"5f7cefe98c3d2e2bd862b3fe"</span><span class="p">)},</span>
    <span class="p">{</span>
      <span class="nx">$set</span><span class="o">:</span><span class="p">{</span><span class="s2">"borough"</span><span class="o">:</span><span class="s2">"Manhattan"</span><span class="p">},</span>
      <span class="nx">$currentDate</span><span class="o">:</span><span class="p">{</span><span class="s2">"lastUpdated"</span><span class="o">:</span><span class="kc">true</span><span class="p">}</span>
    <span class="p">}</span>
  <span class="p">)</span>
</code></pre></div> </div> <input id="__tabbed_19_2" name="__tabbed_19" type="radio"/><label for="__tabbed_19_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">UPDATE</span> <span class="n">restaurants</span> 
<span class="k">SET</span> 
  <span class="n">borough</span> <span class="o">=</span> <span class="s1">'Manhattan'</span><span class="p">,</span> 
  <span class="n">lastUpdated</span> <span class="o">=</span> <span class="n">sysdate</span><span class="p">,</span> 
<span class="k">WHERE</span> <span class="n">_id</span> <span class="o">=</span> <span class="s1">'5f7cefe98c3d2e2bd862b3fe'</span>
</code></pre></div> </div> </div> </details> <details class="example" open="open"><summary>Exemple 2</summary><p>Supprimer le champ cuisine et ajouter 2 point au premier score du restaurant avec l'identifiant 5f7cefe98c3d2e2bd862b3fe</p> <div class="tabbed-set" data-tabs="20:1"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio"/><label for="__tabbed_20_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span>
    <span class="p">{</span><span class="nx">_id</span><span class="o">:</span><span class="nx">ObjectId</span><span class="p">(</span><span class="s2">"5f7cefe98c3d2e2bd862b3fe"</span><span class="p">)},</span>
    <span class="p">{</span>
      <span class="nx">$unset</span><span class="o">:</span><span class="p">{</span><span class="s2">"cuisine"</span><span class="o">:</span><span class="s2">""</span><span class="p">},</span>
      <span class="nx">$inc</span><span class="o">:</span><span class="p">{</span><span class="s2">"grades.0.score"</span><span class="o">:</span><span class="mi">2</span><span class="p">},</span>
    <span class="p">}</span>
  <span class="p">)</span>
</code></pre></div> </div> </div> </details> <details class="example" open="open"><summary>Exemple 3</summary><p>Ajouter un commentaire avec la valeur acceptable pour les restaurants qui n'ont pas eu le grade 'C'.</p> <div class="tabbed-set" data-tabs="21:1"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio"/><label for="__tabbed_21_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">update</span> <span class="p">(</span>
    <span class="p">{</span><span class="s2">"grades.grade"</span> <span class="o">:</span> <span class="p">{</span><span class="nx">$not</span> <span class="o">:</span> <span class="p">{</span><span class="nx">$eq</span> <span class="o">:</span> <span class="s2">"C"</span><span class="p">}}},</span>
    <span class="p">{</span><span class="nx">$set</span> <span class="o">:</span> <span class="p">{</span><span class="s2">"comment"</span> <span class="o">:</span> <span class="s2">"acceptable"</span><span class="p">}},</span>
    <span class="p">{</span><span class="s2">"multi"</span> <span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
  <span class="p">)</span>
</code></pre></div> </div> </div> </details> <p><strong>Exercice</strong><br/> Donner la commande qui permet d'annuler celle de l'exemple 2.</p> <h2 id="suppression">Suppression<a class="headerlink" href="#suppression" title="Permanent link">¶</a></h2> <details class="hint" open="open"><summary>Remove</summary><div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span>
    <span class="p">{</span><span class="nx">filtre</span><span class="p">},</span>
    <span class="p">{</span><span class="nx">justOne</span><span class="o">:</span><span class="kc">true</span><span class="o">|</span><span class="kc">false</span><span class="p">}</span> <span class="c1">//Optionnel par défaut false</span>
  <span class="p">)</span>
</code></pre></div> </details> <details class="example" open="open"><summary>Exemple</summary><p>Supprimer tous les restaurants dont le nom commence par M.</p> <div class="tabbed-set" data-tabs="22:2"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio"/><label for="__tabbed_22_1">MongoDB</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">restaurants</span><span class="p">.</span><span class="nx">remove</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="sr">/^M.*/</span><span class="p">})</span>
</code></pre></div> </div> <input id="__tabbed_22_2" name="__tabbed_22" type="radio"/><label for="__tabbed_22_2">SQL</label><div class="tabbed-content"> <div class="highlight"><pre><span></span><code>  <span class="k">DELETE</span>  <span class="k">FROM</span> <span class="n">restaurants</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="k">like</span> <span class="s1">'M%'</span><span class="p">;</span>
</code></pre></div> </div> </div> </details> </article> </div> </div> </main> <footer class="md-footer"> <div class="md-footer-nav"> <nav aria-label="Footer" class="md-footer-nav__inner md-grid"> <a class="md-footer-nav__link md-footer-nav__link--prev" href="installation.html" rel="prev"> <div class="md-footer-nav__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg> </div> <div class="md-footer-nav__title"> <div class="md-ellipsis"> <span class="md-footer-nav__direction"> Précédent </span> Installation et configuration </div> </div> </a> <a class="md-footer-nav__link md-footer-nav__link--next" href="advanced.html" rel="next"> <div class="md-footer-nav__title"> <div class="md-ellipsis"> <span class="md-footer-nav__direction"> Suivant </span> Opérations avancées </div> </div> <div class="md-footer-nav__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-footer-copyright"> <div class="md-footer-copyright__highlight"> Copyright © 2020 - Dr. Hmida Hmida </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a>  ... <a class="link--pdf-download" download href="pdf\TP- MongoDB.pdf" title="PDF">download PDF</a></div> <div class="md-footer-social"> <a class="md-footer-social__link" href="https://gitlab.com/hhmida" rel="noopener" target="_blank" title="gitlab.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M105.2 24.9c-3.1-8.9-15.7-8.9-18.9 0L29.8 199.7h132c-.1 0-56.6-174.8-56.6-174.8zM.9 287.7c-2.6 8 .3 16.9 7.1 22l247.9 184-226.2-294zm160.8-88l94.3 294 94.3-294zm349.4 88l-28.8-88-226.3 294 247.9-184c6.9-5.1 9.7-14 7.2-22zM425.7 24.9c-3.1-8.9-15.7-8.9-18.9 0l-56.6 174.8h132z"></path></svg> </a> <a class="md-footer-social__link" href="https://github.com/hhmida" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </a> <a class="md-footer-social__link" href="https://linkedin.com/in/hhmida" rel="noopener" target="_blank" title="linkedin.com"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg> </a> </div> </div> </div> </footer> </div> <script src="assets/javascripts/vendor.77e55a48.min.js"></script> <script src="assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copier dans le presse-papier", "clipboard.copied": "Copi\u00e9 dans le presse-papier", "search.config.lang": "fr", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: ".",
          features: ['navigation.tabs', 'navigation.instant'],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>